{"version":3,"sources":["../src/dd_categories.js"],"names":["setupSortableLists","SortableList","moveHandlerSelector","on","EVENTS","DROP","categoryListElements","parent","remove","val","getParentCategoryList","setCatOrder","JSON","stringify","updatedCategories","Ajax","call","methodname","args","categories","then","response","console","log","parse","newcatorder","i","length","listItems","querySelectorAll","listOrder","j","firstChild","innerText","propercatname","substr","lastIndexOf","init"],"mappings":"gNAwBA,OACA,OACA,OACA,O,sDAOMA,CAAAA,CAAkB,CAAG,UAAM,CAC7B,GAAIC,UAAJ,CACI,gBADJ,CAEI,CACIC,mBAAmB,CAAE,YADzB,CAFJ,EAOA,cAAO,YAAP,EAAqBC,EAArB,CAAwBF,UAAaG,MAAb,CAAoBC,IAA5C,CAAkD,UAAM,CACpD,GAAIC,CAAAA,CAAoB,CAAG,cAAO,YAAP,EAAqBC,MAArB,EAA3B,CACA,cAAO,qBAAP,EAA8BC,MAA9B,GACA,GAAIC,CAAAA,CAAG,CAAGC,CAAqB,CAACJ,CAAD,CAA/B,CACAK,CAAW,CAACC,IAAI,CAACC,SAAL,CAAeJ,CAAf,CAAD,CACd,CALD,CAMH,C,CAOME,CAAW,CAAG,SAACG,CAAD,CAAuB,CACxC,GAAML,CAAAA,CAAG,CAAGM,UAAKC,IAAL,CAAU,CAAC,CACnBC,UAAU,CAAE,kCADO,CAEnBC,IAAI,CAAE,CAAEC,UAAU,CAAEL,CAAd,CAFa,CAAD,CAAV,CAAZ,CAKAL,CAAG,CAAC,CAAD,CAAH,CAAOW,IAAP,CAAY,SAACC,CAAD,QAAcC,CAAAA,OAAO,CAACC,GAAR,CAAYX,IAAI,CAACY,KAAL,CAAWH,CAAX,CAAZ,CAAd,CAAZ,CACH,C,CAEKX,CAAqB,CAAG,SAACJ,CAAD,CAA0B,CAEpD,OADImB,CAAAA,CAAW,CAAG,EAClB,CAASC,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGpB,CAAoB,CAACqB,MAAzC,CAAiDD,CAAC,EAAlD,CAAsD,CAGlD,OAFIE,CAAAA,CAAS,CAAGtB,CAAoB,CAACoB,CAAD,CAApB,CAAwBG,gBAAxB,CAAyC,cAAzC,CAEhB,CADIC,CAAS,CAAG,EAChB,CAASC,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGH,CAAS,CAACD,MAA9B,CAAsCI,CAAC,EAAvC,CAA2C,IACnCZ,CAAAA,CAAU,CAAGS,CAAS,CAACG,CAAD,CAAT,CAAaC,UAAb,CAAwBC,SADF,CAEnCC,CAAa,CAAGf,CAAU,CAACgB,MAAX,CAAkB,CAAlB,CAAqBhB,CAAU,CAACiB,WAAX,CAAuB,GAAvB,CAArB,CAFmB,CAGvCN,CAAS,CAACC,CAAD,CAAT,CAAeG,CAClB,CACLT,CAAW,CAACC,CAAD,CAAX,CAAiBI,CAChB,CACD,MAAOL,CAAAA,CACV,C,QAEmB,QAAPY,CAAAA,IAAO,EAAM,CACtBrC,CAAkB,EACrB,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript for report card display and processing.\n *\n * @package    qbank_managecategories\n * @author     Ghaly Marc-Alexandre <marc-alexandreghaly@catalyst-ca.net>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *\n*/\n\nimport Ajax from 'core/ajax';\nimport Notification from 'core/notification';\nimport SortableList from 'core/sortable_list';\nimport jQuery from 'jquery';\n\n/**\n * Sets up sortable list in the column sort order page.\n *\n * @returns {Void}\n */\nconst setupSortableLists = () => {\n    new SortableList(\n        '.category_list',\n        {\n            moveHandlerSelector: '.list_item',\n        }\n    );\n\n    jQuery('.list_item').on(SortableList.EVENTS.DROP, () => {\n        let categoryListElements = jQuery('.list_item').parent();\n        jQuery('li.list_item[style]').remove();\n        let val = getParentCategoryList(categoryListElements);\n        setCatOrder(JSON.stringify(val));\n    });\n};\n\n/**\n * Call external function set_order - inserts the updated column in the config_plugins table.\n *\n * @returns {Void}\n */\n const setCatOrder = (updatedCategories) => {\n    const val = Ajax.call([{\n        methodname: 'core_question_set_category_order',\n        args: { categories: updatedCategories },\n        //fail: Notification.exception\n    }]);\n    val[0].then((response) => console.log(JSON.parse(response)));\n};\n\nconst getParentCategoryList = (categoryListElements) => {\n    let newcatorder = [];\n    for (let i = 0; i < categoryListElements.length; i++) {\n        let listItems = categoryListElements[i].querySelectorAll('li.list_item');\n        let listOrder = [];\n        for (let j = 0; j < listItems.length; j++) {\n            let categories = listItems[j].firstChild.innerText;\n            let propercatname = categories.substr(0, categories.lastIndexOf('('));\n            listOrder[j] = propercatname;\n        }\n    newcatorder[i] = listOrder;\n    }\n    return newcatorder;\n};\n\nexport const init = () => {\n    setupSortableLists();\n};"],"file":"dd_categories.min.js"}